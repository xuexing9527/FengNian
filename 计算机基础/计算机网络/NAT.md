# NAT
## 什么是 NAT
Network Address Translation ，网络地址转换。一种将私有网络地址与公网地址之间进行转换的技术，常用于多个设备共享一个公网 IP 访问互联网。

````markdown
家庭 NAT（路由器级）
----------------------------------
[手机 192.168.1.2]
[电脑 192.168.1.3]
         │
         ▼
   家庭路由器 NAT
         │  公网 IP: 1.2.3.4
         ▼
      Internet
````

## 为什么叫 “Network Address Translation”

最早的 NAT 出现在 1990 年代初，背景是 IPv4 地址严重不足。

作用：

内部网络使用私有 IP（192.168.x.x、10.x.x.x、172.16.x.x）；

出公网时，把私有 IP 映射成公网 IP，并记录端口映射。

关键点：NAT 不只转换 192 开头的 IP，而是 所有私有 IP 到公网 IP 的映射。

“Network Address”指的就是 任何网络地址（IP），不仅限 192。

“Translation”强调 一一对应或者端口映射关系的改变，让多个内部 IP 可以安全访问外网。

## 历史渊源

### 1. IPv4 不够用

1990 年代，互联网爆发，IPv4 总共 ~43 亿个地址，不够全球用户使用。

### 2. RFC 1631（1994）

首次标准化 NAT 概念，允许内部网络用私有地址，通过 NAT 上网。

### 3. CGNAT 出现

- 进入 2000 年代，ISP 开始面临 大规模 IPv4 地址紧张问题；

CGNAT 被提出来：运营商端把 NAT 做成大规模系统，让 成千上万用户共享少量公网 IP。

### 4. 为什么专门起个名词

- 家庭 NAT 是小规模、用户自建的；

- CGNAT 强调 运营商级别、大量用户共享、端口管理复杂、会影响某些应用。

- 所以需要区分：不是普通 NAT，是 Carrier-Grade。

```` markdown
CGNAT 示意图：

用户A [192.168.1.2]
用户B [192.168.1.2]
用户C [10.0.0.5]
         │
         ▼
   运营商 CGNAT
(公网 IP: 203.0.113.10)
         │
         ▼
      Internet
````